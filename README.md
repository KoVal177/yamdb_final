# Разворачивание проекта ["Yamdb"](https://github.com/KoVal177/api_yamdb/) на Docker и отдельном сервере.
  
### Состояние
https://github.com/<OWNER>/<REPOSITORY>/actions/workflows/<WORKFLOW_FILE>/badge.svg

![workflow](https://github.com/KoVal177/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)
![event parameter](https://github.com/KoVal177/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg?event=push)
![branch parameter](https://github.com/KoVal177/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg?branch=master)

### Действия
При добавлении изменений в репозиторий выполняются следующие действия:   
1. Производится тестирование и проверка синтаксиса;
2. Компилируется новый образ проекта и выкладывается на [Docker Hub](https://hub.docker.com/) (только при push в ветку `master`);
3. На удаленном сервере в [Yandex Cloud](https://cloud.yandex.ru/) разворачивается проект с учетом внесенных изменений;
4. Загружается статика, производятся миграции и добавление в базу тестовых данных.
5. Администратору через telegram отправляется уведомление, если все действия были произведены успешно.
  
Работающий сервер находится по адресу [vkyatube.sytes.net/](http://vkyatube.sytes.net/)  
Результат выполнения запроса "Выдать названия всех произведений" - [vkyatube.sytes.net/api/v1/titles/](http://vkyatube.sytes.net/api/v1/titles/)

# Проект «YaMDb»
### Описание
Проект YaMDb собирает отзывы (Review) пользователей на произведения (Titles).  
Произведения делятся на категории: «Книги», «Фильмы», «Музыка».  
Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.  
В каждой категории есть конкретные произведения: книги, фильмы или музыка.  
Произведению может быть присвоен жанр (Genre) из списка предустановленных  
(например, «Сказка», «Рок» или «Артхаус»).  
Пользователи оставляют к произведениям текстовые отзывы (Review) и ставят произведению оценку  
в диапазоне от одного до десяти (целое число);  
из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число).  
**Предусмотрены следующие пользовательские роли:**  
**Аноним** — может просматривать описания произведений, читать отзывы и комментарии.  
**Аутентифицированный пользователь (user)** — может, как и Аноним, читать всё,  
дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам),  
может комментировать чужие   отзывы; может редактировать и удалять свои отзывы и комментарии.  
Эта роль присваивается по умолчанию каждому новому пользователю.  
**Модератор (moderator)** — те же права, что и у Аутентифицированного пользователя плюс право удалять  
любые отзывы и комментарии.  
**Администратор (admin)** — полные права на управление всем контентом проекта.  
Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.  
**Суперюзер Django** — обладет правами администратора (admin)  
### Технологии
- **Python 3.7**
- **Django 2.2.16**
- **Django Rest Framework 3.12.4**
- **SimpleJWT 4.8.0**
  
### Примеры работы с проектом
**Алгоритм регистрации пользователей**  
1.Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт /api/v1/auth/signup/.
2.YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.
3.Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).
4.При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле.  
*Примеры:*
*При POST запросе на эндпоинт /api/v1/auth/signup/ с таким содержимым:*  
*{*  
*"email": "string",*  
*"username": "string"*  
*}*  
*Будет отправлен confirmation_code на адрес email и получен ответ со статусом 200.*  
*Далее необходимо подтвердить регистрацию. При POST запросе на эндпоинт /api/v1/auth/token/ с таким содержимым:*  
*{*  
*"username": "string",*  
*"confirmation_code": "string"*  
*}*  
*В ответ будет получен jwt-токен:*  
*{*  
*"token": "string",*  
*}*  
**Работа с категориями**  
Любой пользователь может посмотреть список категорий, отправив GET-запрос на эндпоинт /api/v1/categories/  
В ответ придет *пагинированный* перечень:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Добавить категорию может только администратор, отправив следующий POST-запрос на эндпоинт /api/v1/categories/:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Администратор также может удалить категорию, отправив соответствующий запрос на эндпоинт /api/v1/categories/{slug}/  
**Работа с жанрами**  
Любой пользователь может посмотреть список жанров, отправив GET-запрос на эндпоинт /api/v1/genres/  
В ответ придет *пагинированный* перечень:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Добавить жанр может только администратор, отправив следующий POST-запрос на эндпоинт /api/v1/genres/:  
*{*  
*"name": "string",*  
*"slug": "string"*  
*}*  
Администратор также может удалить жанр, отправив соответствующий запрос на эндпоинт /api/v1/genres/{slug}/  
**Для более подробного описания запустите сервер и перейдите по ссылке http://vkyatube.sytes.net/redoc/**  
